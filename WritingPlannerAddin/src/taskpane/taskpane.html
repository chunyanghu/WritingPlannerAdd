<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>写作计划助手</title>
    
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    
	<!-- 在 Office.js 之后添加 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="taskpane.css">
</head>
<body>
    <div class="container-fluid">
        <div class="header">
            <h2>写作计划助手</h2>
        </div>
        
        <!-- 标签页 -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="plan-tab" data-toggle="tab" href="#plan" role="tab">计划设置</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="progress-tab" data-toggle="tab" href="#progress" role="tab">进度追踪</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="stats-tab" data-toggle="tab" href="#stats" role="tab">统计分析</a>
            </li>
        </ul>
        
        <div class="tab-content" id="myTabContent">
            <!-- 计划设置标签页 -->
            <div class="tab-pane fade show active" id="plan" role="tabpanel">
                <div class="form-group mt-3">
                    <label for="projectName">项目名称</label>
                    <input type="text" class="form-control" id="projectName" placeholder="输入项目名称">
                </div>
                
                <div class="form-group">
                    <label for="targetWords">目标字数</label>
                    <input type="number" class="form-control" id="targetWords" placeholder="10000">
                </div>
                
                <div class="form-group">
                    <label for="deadline">截止日期</label>
                    <input type="date" class="form-control" id="deadline">
                </div>
                
                <div class="form-group">
                    <label for="dailyTarget">每日目标字数</label>
                    <input type="number" class="form-control" id="dailyTarget" placeholder="500">
                </div>
                
                <div class="form-group">
                    <label for="reminderTime">提醒时间</label>
                    <input type="time" class="form-control" id="reminderTime" value="09:00">
                </div>
                
                <button class="btn btn-primary btn-block" id="savePlan">保存计划</button>
            </div>
            
            <!-- 进度追踪标签页 -->
            <div class="tab-pane fade" id="progress" role="tabpanel">
                <div class="progress-info mt-3">
                    <h4>当前进度</h4>
                    <div class="progress mb-3">
                        <div class="progress-bar" role="progressbar" id="progressBar" style="width: 0%">0%</div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-item">
                            <h5>当前字数</h5>
                            <p id="currentWords">0</p>
                        </div>
                        <div class="stat-item">
                            <h5>目标字数</h5>
                            <p id="targetWordsDisplay">0</p>
                        </div>
                        <div class="stat-item">
                            <h5>剩余天数</h5>
                            <p id="daysLeft">0</p>
                        </div>
                        <div class="stat-item">
                            <h5>今日已写</h5>
                            <p id="todayWords">0</p>
                        </div>
                    </div>
                    
                    <button class="btn btn-success btn-block mt-3" id="updateProgress">更新进度</button>
                </div>
            </div>
            
            <!-- 统计分析标签页 -->
            <div class="tab-pane fade" id="stats" role="tabpanel">
                <div class="chart-container mt-3">
                    <canvas id="progressChart"></canvas>
                </div>
                
                <div class="history mt-3">
                    <h5>写作历史</h5>
                    <div id="historyList" class="list-group">
                        <!-- 动态生成历史记录 -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="taskpane.js"></script>
</body>
</html>
